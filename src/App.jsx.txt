import React, { useState, useEffect } from 'react';
import { 
  Lock, Sparkles, X, Gift, Settings, TreePine,
  Coffee, CloudSun, Heart, Feather, Compass, Cat, Shield, 
  Smile, ShoppingBag, BatteryCharging, Wind, Clock, 
  BookOpen, Rocket, Moon, Crown, Users, Puzzle, PartyPopper,
  Music, Sun, Anchor, Eye
} from 'lucide-react'; 
import { initializeApp } from 'firebase/app';
import { 
  getAuth, 
  signInAnonymously, 
  onAuthStateChanged
} from 'firebase/auth';
import { 
  getFirestore, 
  collection, 
  doc, 
  setDoc, 
  onSnapshot, 
  serverTimestamp 
} from 'firebase/firestore';

// --- –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø FIREBASE ---
// ‚ö†Ô∏è –°–Æ–î–ê –ù–£–ñ–ù–û –í–°–¢–ê–í–ò–¢–¨ –¢–í–û–ô –†–ï–ê–õ–¨–ù–´–ô –ö–û–ù–§–ò–ì –ò–ó FIREBASE –ö–û–ù–°–û–õ–ò
// –§–æ—Ä–º–∞—Ç:
// const firebaseConfig = {
//   apiKey: "...",
//   authDomain: "...",
//   projectId: "...",
//   storageBucket: "...",
//   messagingSenderId: "...",
//   appId: "..."
 // };
const firebaseConfig = {
  apiKey: "YOUR_API_KEY",
  authDomain: "YOUR_AUTH_DOMAIN",
  projectId: "YOUR_PROJECT_ID",
  storageBucket: "YOUR_STORAGE_BUCKET",
  messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
  appId: "YOUR_APP_ID",
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);
const appId = 'lifepactic-advent';

// --- –¶–í–ï–¢–û–í–ê–Ø –ü–ê–õ–ò–¢–†–ê –ò –ö–û–ù–°–¢–ê–ù–¢–´ ---
const COLORS = {
  white: '#ffffff',
  dawnPink: '#f1eae0',     // –§–æ–Ω
  tuatara: '#363636',      // –¢–µ–∫—Å—Ç
  fireEngineRed: '#c82926', // –ê–∫—Ü–µ–Ω—Ç
  kimberly: '#706c91',     // –ê–∫—Ü–µ–Ω—Ç 2
  rodeoDust: '#c7b895',    // –î–ª—è –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö
  bone: '#e3dbca',         // –î–ª—è –æ—Ç–∫—Ä—ã—Ç—ã—Ö
  forestGreen: '#2f855a',  // –î–ª—è –µ–ª–∫–∏
};

// --- –°–ü–ò–°–û–ö –ü–û–ñ–ï–õ–ê–ù–ò–ô ---
const WISHES_POOL = [
  "–¢—ã ‚Äî –∞–≤—Ç–æ—Ä —Å–≤–æ–µ–π –∏—Å—Ç–æ—Ä–∏–∏, –¥–∞–∂–µ –µ—Å–ª–∏ —Å–µ–π—á–∞—Å —Å–ª–æ–∂–Ω–∞—è –≥–ª–∞–≤–∞ - —Å–∞–º–æ–µ –≤—Ä–µ–º—è –ø–∏—Å–∞—Ç—å —Å–ª–µ–¥—É—é—â—É—é!",
  "–ù–∞–π–¥–∏ —Å–µ–≥–æ–¥–Ω—è –º–∏–Ω—É—Ç—É —Ä–∞–∑–º–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ ‚Äî —Ç–∞–∫–æ–π, –∫–∞–∫ –∫–æ–≥–¥–∞ –Ω–∞–±–ª—é–¥–∞–µ—à—å –∑–∞ —Å–Ω–µ–∂–∏–Ω–∫–∞–º–∏ –∏ –ø—Ä–æ—Å—Ç–æ –¥—ã—à–∏—à—å.",
  "–£—Å—Ç—Ä–æ–π —Å–µ–±–µ 30 –º–∏–Ω—É—Ç –Ω–∏—á–µ–≥–æ–Ω–µ–¥–µ–ª–∞–Ω–∏—è ‚Äî –ø–æ–±—É–¥—å –≤ –º–æ–º–µ–Ω—Ç–µ –±–µ–∑ –∑–∞–¥–∞—á, —Å–ø–µ—à–∫–∏ –∏ —Ç—Ä–µ–≤–æ–≥–∏. –ù–∞—Å–ª–∞–¥–∏—Å—å –º–æ–º–µ–Ω—Ç–æ–º.",
  "–ü–æ–¥–∞—Ä–∏ —Å–µ–±–µ —Å–µ–≥–æ–¥–Ω—è –Ω–µ–º–Ω–æ–≥–æ —Ç–µ–ø–ª–∞ ‚Äî –ø–æ–∑–≤–æ–Ω–∏ –±–ª–∏–∑–∫–æ–º—É –∏–ª–∏ –æ–±–Ω–∏–º–∏ —Ç–æ–≥–æ, –∫—Ç–æ —Ä—è–¥–æ–º.",
  "–ù–∞–π–¥–∏ –≤—Ä–µ–º—è –¥–ª—è —É–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Ö–æ—Ä–æ—à–µ–π –∫–Ω–∏–≥–æ–π.",
  "–û—Ç–∫—Ä–æ–π –¥–µ–Ω—å –¥–ª—è –Ω–æ–≤–æ–≥–æ –∑–Ω–∞–∫–æ–º—Å—Ç–≤–∞ ‚Äî –º–∞–ª–µ–Ω—å–∫–æ–≥–æ, –Ω–æ –≤–¥–æ—Ö–Ω–æ–≤–ª—è—é—â–µ–≥–æ.",
  "–ü–æ–ø–æ–ª–Ω–∏ –∑–∞–ø–∞—Å —ç–Ω–µ—Ä–≥–∏–∏ ‚Äî —á–µ–º-—Ç–æ –≤–∫—É—Å–Ω—ã–º, —Ç—ë–ø–ª—ã–º –∏–ª–∏ –ø—Ä–∏—è—Ç–Ω—ã–º.",
  "–û—Ç–º–µ—Ç—å —Å–≤–æ—ë –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ ‚Äî –¥–∞–∂–µ –µ—Å–ª–∏ –æ–Ω–æ –∫—Ä–æ—à–µ—á–Ω–æ–µ, –æ–Ω–æ —Ç–≤–æ—ë.",
  "–°–¥–µ–ª–∞–π –ø–∞—É–∑—É —Ä–∞–¥–∏ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –æ—Ç–¥—ã—Ö–∞, –∞ –Ω–µ ¬´–Ω–∞ –±–µ–≥—É¬ª.",
  "–£—Å—Ç—Ä–æ–π —Å–µ–±–µ –º–∞–ª–µ–Ω—å–∫–∏–π —Ä–∏—Ç—É–∞–ª, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–≤—ã—à–∞–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ –∂–∏–∑–Ω–∏.",
  "–ü–æ–∑–∞–±–æ—Ç—å—Å—è –æ —Å–µ–±–µ —Ç–∞–∫ –∂–µ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ, –∫–∞–∫ –æ –ø—Ä–æ–µ–∫—Ç–µ.",
  "–°–∫–∞–∂–∏ —Å–µ–±–µ —á—Ç–æ-—Ç–æ –¥–æ–±—Ä–æ–µ ‚Äî —Ç–∞–∫, –∫–∞–∫ —Å–∫–∞–∑–∞–ª –±—ã –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É –∫–æ–ª–ª–µ–≥e.",
  "–°–ø—Ä–æ—Å–∏ —Å–µ–±—è: –ß—Ç–æ –±—ã —è —Å–¥–µ–ª–∞–ª –¥–ª—è –¥—Ä—É–≥–∞? ‚Äî –∏ —Å–¥–µ–ª–∞–π —ç—Ç–æ –¥–ª—è —Å–µ–±—è.",
  "–ü–æ–∂–µ–ª–∞–π –∫–æ–º—É-—Ç–æ —Ö–æ—Ä–æ—à–µ–≥–æ –¥–Ω—è ‚Äî –∏—Å–∫—Ä–µ–Ω–Ω–µ.",
  "–°–¥–µ–ª–∞–π —Å–µ–≥–æ–¥–Ω—è –º–∞–ª–µ–Ω—å–∫–∏–π —Å–º–µ–ª—ã–π —à–∞–≥.",
  "–ü—Ä–∏–º–∏ —Ä–µ—à–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –¥–∞–≤–Ω–æ –æ—Ç–∫–ª–∞–¥—ã–≤–∞–ª.",
  "–°–¥–µ–ª–∞–π —à–∞–≥ –∫ —Ç–æ–º—É, –∫–µ–º —Ö–æ—á–µ—à—å –±—ã—Ç—å –≤ –Ω–æ–≤–æ–º –≥–æ–¥—É.",
  "–ù–∞–π–¥–∏ —Ç–æ, —á—Ç–æ –¥–µ–ª–∞–µ—Ç —Ç–µ–±—è –æ—Å–æ–±–µ–Ω–Ω—ã–º ‚Äî –∏ —É–ª—ã–±–Ω–∏—Å—å —ç—Ç–æ–º—É.",
  "–û—Ç–º–µ—á–∞–π –Ω–µ–æ–±—ã—á–Ω—ã–µ –º—ã—Å–ª–∏ ‚Äî —Ç–∞–º –∏—Å—Ç–æ—á–Ω–∏–∫ —Ç–≤–æ—Ä—á–µ—Å—Ç–≤–∞.",
  "–ü–æ–∑–≤–æ–ª—å —Å–µ–±–µ –±—ã—Ç—å ¬´—Å—Ç—Ä–∞–Ω–Ω—ã–º¬ª —Ä–æ–≤–Ω–æ –Ω–∞—Å—Ç–æ–ª—å–∫–æ, —á—Ç–æ–±—ã —á—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å —Å–µ–±—è.",
  "–ü—Ä–∏–º–∏ –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç —Å–≤–æ–µ–π –Ω–µ–ø–æ–≤—Ç–æ—Ä–∏–º–æ—Å—Ç–∏.",
  "–ü—Ä–∏–∑–Ω–∞–π, —á—Ç–æ —Ç—ã —Å–µ–≥–æ–¥–Ω—è —á—É–≤—Å—Ç–≤—É–µ—à—å ‚Äî –±–µ–∑ —Ñ–∏–ª—å—Ç—Ä–æ–≤.",
  "–°–∫–∞–∂–∏ —Å–µ–±–µ –ø—Ä–∞–≤–¥—É –ø—Ä–æ —Å–≤–æ–∏ –∂–µ–ª–∞–Ω–∏—è.",
  "–ü—Ä–∏–º–∏ –ø–æ—Ö–≤–∞–ª—É —á–µ—Å—Ç–Ω–æ, –±–µ–∑ –æ–±–µ—Å—Ü–µ–Ω–∏–≤–∞–Ω–∏—è.",
  "–°–ø—Ä–æ—Å–∏ —Å–µ–±—è: ‚Äú–ß—Ç–æ –º–Ω–µ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –Ω—É–∂–Ω–æ —Å–µ–π—á–∞—Å?‚Äù",
  "–ü—Ä–∏–∑–Ω–∞–π —Å–≤–æ—é —Å–∏–ª—É ‚Äî –±–µ–∑ —Å–∫—Ä–æ–º–Ω–æ—Å—Ç–∏.",
  "–£–∑–Ω–∞–π —Å–µ–≥–æ–¥–Ω—è —á—Ç–æ-—Ç–æ –Ω–æ–≤–æ–µ ‚Äî –ø—É—Å—Ç—å –¥–∞–∂–µ –æ–¥–Ω—É —Å—Ç—Ä–æ—á–∫—É.",
  "–°–¥–µ–ª–∞–π —à–∞–≥ –≤–ø–µ—Ä—ë–¥ —Ç–∞–º, –≥–¥–µ –æ–±—ã—á–Ω–æ —Å–æ–º–Ω–µ–≤–∞–µ—à—å—Å—è.",
  "–ü–æ—Å–º–æ—Ç—Ä–∏ –Ω–∞ –∑–∞–¥–∞—á—É –ø–æ–¥ –¥—Ä—É–≥–∏–º —É–≥–ª–æ–º.",
  "–°–ø—Ä–æ—Å–∏ —É —Å–µ–±—è: ‚Äú–ß—Ç–æ –Ω–æ–≤–æ–µ —è –º–æ–≥—É –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–µ–≥–æ–¥–Ω—è?‚Äù",
  "–°–¥–µ–ª–∞–π –æ–¥–Ω—É –≤–µ—â—å, –∫–æ—Ç–æ—Ä–∞—è –¥–µ–ª–∞–µ—Ç —Ç–µ–±—è –ª—É—á—à–µ, —á–µ–º –≤—á–µ—Ä–∞.",
  "–û—Ç–º–µ—Ç—å, –≥–¥–µ —Ç—ã —É–∂–µ –≤—ã—Ä–æ—Å –∫–∞–∫ —á–µ–ª–æ–≤–µ–∫?",
  "–ü–æ–∑–≤–æ–ª—å —Å–µ–±–µ –æ—à–∏–±–∞—Ç—å—Å—è ‚Äî —Ä–∞–¥–∏ —Ä–æ—Å—Ç–∞.",
  "–ü–æ–¥—É–º–∞–π –æ –≤–µ—Ä—Å–∏–∏ —Å–µ–±—è —á–µ—Ä–µ–∑ –≥–æ–¥ ‚Äî –∏ —Å–¥–µ–ª–∞–π —à–∞–≥ –∫ –Ω–µ–π.",
  "–ù–∞–π–¥–∏ –ª—É—á–∏–∫ —Å–≤–µ—Ç–∞ –≤ —Å–≤–æ—ë–º –¥–Ω–µ ‚Äî –æ–Ω —Ç–æ—á–Ω–æ –µ—Å—Ç—å.",
  "–í—Å–ø–æ–º–Ω–∏, —á—Ç–æ –≤—Å–µ–≥–¥–∞ –µ—Å—Ç—å –ø—É—Ç—å, –¥–∞–∂–µ –µ—Å–ª–∏ –µ–≥–æ –ø–æ–∫–∞ –Ω–µ –≤–∏–¥–Ω–æ.",
  "–ü–æ–¥—É–º–∞–π –æ –±—É–¥—É—â–µ–º, –∫–æ—Ç–æ—Ä–æ–µ –≥—Ä–µ–µ—Ç.",
  "–ü–æ—Å–º–æ—Ç—Ä–∏ –Ω–∞ —á—Ç–æ-—Ç–æ –∫—Ä–∞—Å–∏–≤–æ–µ ‚Äî –∏ –ø–æ—á—É–≤—Å—Ç–≤—É–π –ª—ë–≥–∫–æ—Å—Ç—å.",
  "–°–¥–µ–ª–∞–π —á—Ç–æ-—Ç–æ, —á—Ç–æ –¥–∞—Ä–∏—Ç –æ—â—É—â–µ–Ω–∏–µ ¬´–≤—Å—ë –±—É–¥–µ—Ç —Ö–æ—Ä–æ—à–æ¬ª.",
  "–ü–æ–∑–≤–æ–ª—å —Å–µ–±–µ –ø–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤–ø–µ—Ä–µ–¥–∏ –º–Ω–æ–≥–æ —Ö–æ—Ä–æ—à–µ–≥–æ.",
  "–°–¥–µ–ª–∞–π —Å–µ–≥–æ–¥–Ω—è —á—Ç–æ-—Ç–æ, —á—Ç–æ –≤–¥–æ—Ö–Ω–æ–≤–ª—è–µ—Ç —Ç–µ–±—è —Ö–æ—Ç—è –±—ã –Ω–∞ 1%.",
  "–°–ª—É—à–∞–π –º—É–∑—ã–∫—É, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–¥–Ω–∏–º–∞–µ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ.",
  "–ó–∞–∂–≥–∏ —Å–≤–µ—á—É –∏ —Å–æ–∑–¥–∞–π –∞—Ç–º–æ—Å—Ñ–µ—Ä—É –¥–ª—è —Ç–≤–æ—Ä—á–µ—Å—Ç–≤–∞.",
  "–ü–æ–∑–≤–æ–ª—å —Å–µ–±–µ –º–µ—á—Ç–∞—Ç—å —á—É—Ç—å —Å–º–µ–ª–µ–µ.",
  "–ü–æ—á—É–≤—Å—Ç–≤—É–π –∫—Ä–∞—Å–æ—Ç—É –º–æ–º–µ–Ω—Ç–∞ ‚Äî –¥–∞–∂–µ –µ—Å–ª–∏ –æ–Ω –∫–æ—Ä–æ—Ç–∫–∏–π.",
  "–£—Å—Ç—Ä–æ–π —Å–µ–±–µ –ø—è—Ç–∏ –º–∏–Ω—É—Ç–∫—É —Ç–≤–æ—Ä—á–µ—Å–∫–æ–≥–æ —Ö–∞–æ—Å–∞.",
  "–î–µ–ª–∞–π —á—Ç–æ-—Ç–æ —Å –æ–≥–æ–Ω—å–∫–æ–º ‚Äî –¥–∞–∂–µ –µ—Å–ª–∏ —ç—Ç–æ –º–µ–ª–æ—á—å.",
  "–°–¥–µ–ª–∞–π —á—Ç–æ-—Ç–æ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —Ä–∞–¥–∏ –±—É–¥—É—â–µ–≥–æ —Å–µ–±—è.",
  "–í–¥–æ—Ö–Ω–æ–≤–∏ —Å–µ–±—è –º—ã—Å–ª—å—é, —á—Ç–æ —É —Ç–µ–±—è –ø–æ–ª—É—á–∞–µ—Ç—Å—è.",
  "–ü–æ–∑–≤–æ–ª—å —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ –≤–µ—Å—Ç–∏ —Ç–µ–±—è –≤ —Ä–µ—à–µ–Ω–∏—è—Ö.",
  "–ü—Ä–∏–ª–æ–∂–∏ –ª–∏–¥–µ—Ä—Å—Ç–≤–æ —Ç–∞–º, –≥–¥–µ –Ω—É–∂–µ–Ω –º–∞–ª–µ–Ω—å–∫–∏–π —à–∞–≥ –≤–ø–µ—Ä—ë–¥.",
  "–ü–æ–¥–¥–µ—Ä–∂–∏ –∫–æ–ª–ª–µ–≥—É ‚Äî –∫–∞–∫ –ø–æ–¥–¥–µ—Ä–∂–∞–ª(–∞) –±—ã —Å–µ–±—è.",
  "–ó–∞–º–µ—Ç—å —Ä–æ—Å—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–∏–∑–æ—à—ë–ª –Ω–µ–∑–∞–º–µ—Ç–Ω–æ.",
  "–í—ã–±–µ—Ä–∏ –¥–µ–π—Å—Ç–≤–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –¥–µ–ª–∞–µ—Ç —Ç–µ–±—è –ª—É—á—à–µ.",
  "–û—Ç–¥–∞–≤–∞–π —Å–µ–≥–æ–¥–Ω—è —Å–≤–µ—Ç, –∫–æ—Ç–æ—Ä—ã–π —Ö–æ—á–µ—à—å –ø–æ–ª—É—á–∞—Ç—å.",
  "–ü–æ–π–º–∞–π –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ –≤ –ø—Ä–æ—Å—Ç–æ–º –º–æ–º–µ–Ω—Ç–µ.",
  "–ü—Ä–∏—Å–ª—É—à–∞–π—Å—è –∫ —Å–µ–±–µ —á–µ—Å—Ç–Ω–æ ‚Äî –∏ —Å–¥–µ–ª–∞–π –≤—ã–≤–æ–¥ –º—è–≥–∫–æ.",
  "–£–¥–µ–ª–∏ –≤–Ω–∏–º–∞–Ω–∏–µ —Ç–æ–º—É, —á—Ç–æ –¥–µ–ª–∞–µ—Ç —Ç–µ–±—è —É–Ω–∏–∫–∞–ª—å–Ω—ã–º —á–µ–ª–æ–≤–µ–∫–æ–º.",
  "–ù–∞–π–¥–∏ —Å–µ–≥–æ–¥–Ω—è –º–∏–Ω—É—Ç—É —Ç–∏—à–∏–Ω—ã ‚Äî —Ç–∞–∫—É—é, –≤ –∫–æ—Ç–æ—Ä–æ–π —Å–ª—ã—à–Ω–æ, –∫–∞–∫ –¥–µ–∫–∞–±—Ä—å —É—Å–ø–æ–∫–∞–∏–≤–∞–µ—Ç –≤–æ–∑–¥—É—Ö.",
  "–ü–æ–∑–≤–æ–ª—å —Å–µ–±–µ –∑–∞–º–µ–¥–ª–∏—Ç—å—Å—è —Ç–∞–∫, –±—É–¥—Ç–æ –∑–∞ –æ–∫–Ω–æ–º –≤–ø–µ—Ä–≤—ã–µ –ø–æ—à—ë–ª —Å–Ω–µ–≥.",
  "–ü–æ–¥–∞—Ä–∏ —Å–µ–±–µ –æ—â—É—â–µ–Ω–∏–µ –Ω–∞—á–∞–ª–∞ ‚Äî –∫–∞–∫ —É—Ç—Ä–æ–º –ø–µ—Ä–≤–æ–≥–æ —è–Ω–≤–∞—Ä—è.",
  "–°–¥–µ–ª–∞–π –≥–ª–æ—Ç–æ–∫ –≥–æ—Ä—è—á–µ–≥–æ –Ω–∞–ø–∏—Ç–∫–∞ –∏ –ø–æ—á—É–≤—Å—Ç–≤—É–π, –∫–∞–∫ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —Å–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ.",
  "–°–∫–∞–∂–∏ —Å–µ–±–µ –¥–æ–±—Ä—ã–µ —Å–ª–æ–≤–∞ —Ç–∞–∫, –±—É–¥—Ç–æ –∫–ª–∞–¥—ë—à—å –∏—Ö –ø–æ–¥ –Ω–æ–≤–æ–≥–æ–¥–Ω—é—é —ë–ª–∫—É.",
  "–ü–æ–¥–∞—Ä–∏ —Å–µ–±–µ –æ—â—É—â–µ–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è ‚Äî –±—É–¥—Ç–æ –≥–æ–¥ –≤–æ—Ç-–≤–æ—Ç —Å–º–µ–Ω–∏—Ç—Å—è.",
  "–ü–æ—Å–º–æ—Ç—Ä–∏ –Ω–∞ –æ–≥–æ–Ω—å–∫–∏ –≤–æ–∫—Ä—É–≥ –∏ –æ—Ç–º–µ—Ç—å —Ç–æ, —á—Ç–æ –∑–∞–∂–∏–≥–∞–µ—Ç –≤–Ω—É—Ç—Ä–∏ —Ç–µ–±—è.",
  "–ü–æ–∑–≤–æ–ª—å —Å–µ–±–µ –º–µ—á—Ç–∞—Ç—å —à–∏—Ä–µ ‚Äî –¥–µ–∫–∞–±—Ä—å –ª—é–±–∏—Ç –º–µ—á—Ç—ã.",
  "–£—Å—Ç—Ä–æ–π 30 –º–∏–Ω—É—Ç —É—é—Ç–∞ ‚Äî –ø–ª–µ–¥, —Ç–∏—à–∏–Ω–∞ –∏ —Ç—ã.",
  "–ü—Ä–µ–¥—Å—Ç–∞–≤—å, —á—Ç–æ —ç—Ç–æ—Ç –¥–µ–Ω—å ‚Äî –ø–æ–¥–∞—Ä–æ–∫. –û—Ç–∫—Ä–æ–π –µ–≥–æ –º–µ–¥–ª–µ–Ω–Ω–æ, –Ω–∞—Å–ª–∞–¥–∏—Å—å.",
  "–ù–∞–π–¥–∏ —Å–∏–ª—É –≤ —Å–µ–±–µ ‚Äî —Ç—É —Å–∞–º—É—é, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–º–æ–≥–∞–µ—Ç –∑–∞–≥–∞–¥—ã–≤–∞—Ç—å –∂–µ–ª–∞–Ω–∏—è.",
  "–ü–æ–¥–∞—Ä–∏ —Å–µ–±–µ –Ω–µ–º–Ω–æ–≥–æ –≤–µ—Ä—ã –≤ –ª—É—á—à–µ–µ ‚Äî –∫–∞–∫ –≤ –Ω–æ–≤–æ–≥–æ–¥–Ω—é—é –Ω–æ—á—å.",
  "–ó–∞–º–µ—Ç—å —Å–≤–µ—Ç –≤–æ–∫—Ä—É–≥: –≤ —Å–ª–æ–≤–∞—Ö, –ª—é–¥—è—Ö, –º–æ–º–µ–Ω—Ç–∞—Ö.",
  "–û—Ç–º–µ—Ç—å –≤—Å—ë, —á—Ç–æ —Ç—ã –ø—Ä–æ–∂–∏–ª(–∞) –≤ —ç—Ç–æ–º –≥–æ–¥—É ‚Äî –∏ –ø–æ–±–ª–∞–≥–æ–¥–∞—Ä–∏ —Å–µ–±—è.",
  "–ü–æ–∑–≤–æ–ª—å —Å–µ–±–µ –≤—ã–¥–æ—Ö–Ω—É—Ç—å ‚Äî –∫–∞–∫ –±—É–¥—Ç–æ –∑–∞–∫—Ä—ã–≤–∞–µ—à—å –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞–±–æ—á–∏–π –¥–µ–Ω—å –≥–æ–¥–∞.",
  "–°–æ–∑–¥–∞–π —Å–µ–±–µ –∞—Ç–º–æ—Å—Ñ–µ—Ä—É, –≤ –∫–æ—Ç–æ—Ä–æ–π —Ö–æ—á–µ—Ç—Å—è –±—ã—Ç—å.",
  "–í–¥–æ—Ö–Ω–∏ –≥–ª—É–±–∂–µ ‚Äî –≤–æ–∑–¥—É—Ö –¥–µ–∫–∞–±—Ä—è –≤—Å–µ–≥–¥–∞ —á–∏—â–µ.",
  "–ü–æ—Å–º–æ—Ç—Ä–∏ –Ω–∞ —Å–≤–æ–π –ø—É—Ç—å, –∫–∞–∫ –Ω–∞ –≥–∏—Ä–ª—è–Ω–¥—É –∏–∑ –º–∞–ª–µ–Ω—å–∫–∏—Ö –ø–æ–±–µ–¥.",
  "–ó–∞–∂–≥–∏ —Å–≤–æ—é –≤–Ω—É—Ç—Ä–µ–Ω–Ω—é—é ¬´–ª–∞–º–ø–æ—á–∫—É¬ª ‚Äî –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ–º –∏–ª–∏ –∑–∞–±–æ—Ç–æ–π.",
  "–£—Å—Ç—Ä–æ–π —Å–µ–±–µ –∞—Ä–æ–º–∞—Ç –ø—Ä–∞–∑–¥–Ω–∏–∫–∞ ‚Äî —Ç–µ–º, —á—Ç–æ –ª—é–±–∏—à—å –∏–º–µ–Ω–Ω–æ —Ç—ã.",
  "–ü—Ä–µ–¥—Å—Ç–∞–≤—å, —á—Ç–æ –∫–∞–∂–¥—ã–π —à–∞–≥ —Å–µ–≥–æ–¥–Ω—è ‚Äî —à–∞–≥ –≤ –Ω–æ–≤—ã–π –≥–æ–¥.",
  "–ù–∞–π–¥–∏ —á—Ç–æ-—Ç–æ, —á—Ç–æ –¥–µ–ª–∞–µ—Ç —ç—Ç–æ—Ç –¥–µ–Ω—å –æ—Å–æ–±–µ–Ω–Ω—ã–º.",
  "–£—Å–ª—ã—à—å —Å–≤–æ—ë –∂–µ–ª–∞–Ω–∏–µ ‚Äî —Ç–æ —Å–∞–º–æ–µ, –Ω–∞—Å—Ç–æ—è—â–µ–µ.",
  "–°–¥–µ–ª–∞–π –¥–æ–±—Ä–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ –¥–ª—è —Å–µ–±—è ‚Äî –∫–∞–∫ –ø–æ–¥–∞—Ä–æ–∫ –≤ –¥–µ–∫–∞–±—Ä–µ.",
  "–£—Å—Ç—Ä–æ–π –º–∏–Ω–∏-–æ—á–∏—â–µ–Ω–∏–µ: –≤—ã–±—Ä–æ—Å–∏ –æ–¥–Ω—É –Ω–µ–Ω—É–∂–Ω—É—é –º—ã—Å–ª—å.",
  "–ü–æ–¥–¥–µ—Ä–∂–∏ —Å–µ–±—è —Ç–∞–∫, –∫–∞–∫ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –≤ –ø—Ä–∞–∑–¥–Ω–∏—á–Ω—ã–µ –≤–µ—á–µ—Ä–∞.",
  "–ü–æ—Å–º–æ—Ç—Ä–∏ –Ω–∞ —Å–≤–æ—é –∂–∏–∑–Ω—å –≥–ª–∞–∑–∞–º–∏ —á–µ–ª–æ–≤–µ–∫–∞, –∫–æ—Ç–æ—Ä—ã–π —Ç–µ–±—è –ª—é–±–∏—Ç.",
  "–î–∞–π —Å–µ–±–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ, —á—Ç–æ–±—ã –º–µ—á—Ç–∞—Ç—å –æ —Å–ª–µ–¥—É—é—â–µ–º –≥–æ–¥–µ.",
  "–û–±–Ω–∏–º–∏ —Å–≤–æ—é —Å–µ–≥–æ–¥–Ω—è—à–Ω—é—é –≤–µ—Ä—Å–∏—é ‚Äî –æ–Ω–∞ –¥–æ—Å—Ç–æ–π–Ω–∞ —Ç–µ–ø–ª–∞.",
  "–ü–æ–ø—Ä–æ—Å–∏ —É –¥–µ–∫–∞–±—Ä—è —Ç–æ, —á–µ–≥–æ —Ö–æ—á–µ—à—å ‚Äî –∏ –±—É–¥—å –≥–æ—Ç–æ–≤(–∞) —ç—Ç–æ –ø—Ä–∏–Ω—è—Ç—å.",
  "–í—ã–±–µ—Ä–∏ —Å–µ–≥–æ–¥–Ω—è –æ–¥–Ω–æ –º–∞–ª–µ–Ω—å–∫–æ–µ —É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ –∏ —Å–¥–µ–ª–∞–π –µ–≥–æ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º.",
  "–í—Å–ø–æ–º–Ω–∏, —á–µ–º —Ç—ã –≥–æ—Ä–¥–∏—à—å—Å—è –≤ —Å–µ–±–µ ‚Äî –∏ –ø–æ–±—É–¥—å —Å —ç—Ç–∏–º.",
  "–ù–∞–π–¥–∏ –º–µ—Å—Ç–æ –≤ –¥–Ω–µ, –≥–¥–µ –º–æ–∂–Ω–æ –≤–¥–æ—Ö–Ω—É—Ç—å —Å–≤–µ–∂–∏–π –≤–æ–∑–¥—É—Ö.",
  "–ü–æ–¥–¥–µ—Ä–∂–∏ —Å–µ–±—è —Ç—ë–ø–ª—ã–º–∏ —Å–ª–æ–≤–∞–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –æ–±—ã—á–Ω–æ –≥–æ–≤–æ—Ä–∏—à—å –¥—Ä—É–≥–∏–º.",
  "–ü–æ–ø—Ä–æ—Å–∏ —É –¥–Ω—è –ø–æ–¥—Å–∫–∞–∑–∫—É ‚Äî –∏ –±—É–¥—å –æ—Ç–∫—Ä—ã—Ç—ã–º –∫ –µ—ë –ø–æ–ª—É—á–µ–Ω–∏—é.",
  "–û–±–Ω–∏–º–∏ —Å–≤–æ—é —Å–µ–≥–æ–¥–Ω—è—à–Ω—é—é –≤–µ—Ä—Å–∏—é ‚Äî –≤ –Ω–µ–π —Ç–≤–æ—è —Ç–æ—á–∫–∞ –æ–ø–æ—Ä—ã."
];

// --- –•–ï–õ–ü–ï–†: –ü–û–î–ë–û–† –ò–õ–õ–Æ–°–¢–†–ê–¶–ò–ò ---
const getThematicIllustration = (text) => {
  const props = { size: 48, strokeWidth: 1.5 };
  const lowerText = text.toLowerCase();
  
  if (lowerText.includes("–∫–æ—Ñ–µ") || lowerText.includes("—á–∞–π") || lowerText.includes("–ø–∞—É–∑—É") || lowerText.includes("–æ—Ç–¥—ã—Ö") || lowerText.includes("–Ω–∏—á–µ–≥–æ–Ω–µ–¥–µ–ª–∞–Ω–∏—è") || lowerText.includes("–Ω–∞–ø–∏—Ç–∫–∞") || lowerText.includes("—É—é—Ç")) return <Coffee {...props} color="#795548" />;
  if (lowerText.includes("—Å–æ–ª–Ω—Ü–µ") || lowerText.includes("—Å–≤–µ—Ç") || lowerText.includes("—Ç–µ–ø–ª–∞") || lowerText.includes("–ª—É—á") || lowerText.includes("–æ–≥–æ–Ω—å–∫–∏") || lowerText.includes("–ª–∞–º–ø–æ—á–∫—É")) return <Sun {...props} color="#F59E0B" />;
  if (lowerText.includes("—Å–µ—Ä–¥—Ü–µ") || lowerText.includes("–ª—é–±–æ–≤—å") || lowerText.includes("–æ–±–Ω–∏–º–∏") || lowerText.includes("—Å–µ–±—è") || lowerText.includes("–ª—é–±–∏—à—å") || lowerText.includes("—Å–ª–æ–≤–∞–º–∏")) return <Heart {...props} color="#c82926" />;
  if (lowerText.includes("—Å–Ω–µ–∂–∏–Ω–∫") || lowerText.includes("–Ω–µ–±–æ") || lowerText.includes("—Ç–∏—à–∏–Ω") || lowerText.includes("–∞—Ç–º–æ—Å—Ñ–µ—Ä—É") || lowerText.includes("—Å–Ω–µ–≥") || lowerText.includes("–¥–µ–∫–∞–±—Ä—å")) return <CloudSun {...props} color="#706c91" />;
  if (lowerText.includes("—Ç–≤–æ—Ä—á–µ—Å—Ç–≤") || lowerText.includes("–≤–¥–æ—Ö–Ω–æ–≤") || lowerText.includes("–º—ã—Å–ª–∏") || lowerText.includes("—Ö–∞–æ—Å") || lowerText.includes("–º–µ—á—Ç–∞—Ç—å")) return <Feather {...props} color="#c82926" />;
  if (lowerText.includes("–æ—à–∏–±–∫") || lowerText.includes("–ø–∞–∑–ª") || lowerText.includes("—Ä–µ—à–µ–Ω–∏–µ") || lowerText.includes("–æ—á–∏—â–µ–Ω–∏–µ")) return <Puzzle {...props} color="#706c91" />;
  if (lowerText.includes("–∫–æ—Ç") || lowerText.includes("–∂–∏–≤–æ—Ç–Ω–æ–µ")) return <Cat {...props} color="#363636" />;
  if (lowerText.includes("–Ω–µ—Ç") || lowerText.includes("–≥—Ä–∞–Ω–∏—Ü—ã") || lowerText.includes("–∑–∞—â–∏—Ç") || lowerText.includes("–æ–ø–æ—Ä—ã")) return <Shield {...props} color="#363636" />;
  if (lowerText.includes("–ø–æ–∫—É–ø–∫") || lowerText.includes("–º–∞–≥–∞–∑–∏–Ω")) return <ShoppingBag {...props} color="#c82926" />;
  if (lowerText.includes("—ç–Ω–µ—Ä–≥–∏") || lowerText.includes("–∑–∞—Ä—è–¥") || lowerText.includes("—Å–∏–ª")) return <BatteryCharging {...props} color="#706c91" />;
  if (lowerText.includes("—É–ª—ã–±") || lowerText.includes("—Å–º–µ—Ö") || lowerText.includes("—Ä–∞–¥–æ—Å—Ç—å") || lowerText.includes("—Ö–æ—Ä–æ—à–æ") || lowerText.includes("—Å—á–∞—Å—Ç–ª–∏–≤—ã–º") || lowerText.includes("—É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ")) return <Smile {...props} color="#F59E0B" />;
  if (lowerText.includes("–¥—ã—à–∏") || lowerText.includes("–≤–µ—Ç–µ—Ä") || lowerText.includes("–≤–æ–∑–¥—É—Ö") || lowerText.includes("–≤—ã–¥–æ—Ö–Ω–∏")) return <Wind {...props} color="#706c91" />;
  if (lowerText.includes("–≤—Ä–µ–º—è") || lowerText.includes("–º–∏–Ω—É—Ç") || lowerText.includes("—á–∞—Å—ã") || lowerText.includes("—Ç–µ–º–ø") || lowerText.includes("–∑–∞–º–µ–¥–ª–∏—Ç—å—Å—è")) return <Clock {...props} color="#363636" />;
  if (lowerText.includes("–∫–Ω–∏–≥") || lowerText.includes("—á–∏—Ç–∞") || lowerText.includes("–∞–≤—Ç–æ—Ä") || lowerText.includes("–≥–ª–∞–≤–∞") || lowerText.includes("–∏—Å—Ç–æ—Ä–∏")) return <BookOpen {...props} color="#795548" />;
  if (lowerText.includes("—à–∞–≥") || lowerText.includes("–≤–ø–µ—Ä–µ–¥") || lowerText.includes("—Å—Ç–∞—Ä—Ç") || lowerText.includes("–¥–µ–π—Å—Ç–≤–∏") || lowerText.includes("–Ω–∞—á–∞–ª–∞")) return <Rocket {...props} color="#c82926" />;
  if (lowerText.includes("–∫–æ–º–ø–∞—Å") || lowerText.includes("–ø—É—Ç—å") || lowerText.includes("–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏") || lowerText.includes("–∫–æ–Ω—Ç—Ä–æ–ª—å") || lowerText.includes("–ø–æ–¥—Å–∫–∞–∑–∫—É")) return <Compass {...props} color="#c82926" />;
  if (lowerText.includes("—á—É–¥–æ") || lowerText.includes("–º–∞–≥–∏") || lowerText.includes("–∏—Å–∫—Ä–µ–Ω–Ω–µ") || lowerText.includes("–æ–≥–æ–Ω—å–∫–æ–º") || lowerText.includes("–≤–æ–ª—à–µ–±—Å—Ç–≤–æ")) return <Sparkles {...props} color="#F59E0B" />;
  if (lowerText.includes("–≤–∞–∂–µ–Ω") || lowerText.includes("–∫–æ—Ä–æ–ª—å") || lowerText.includes("–¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ") || lowerText.includes("–ø–æ—Ö–≤–∞–ª") || lowerText.includes("–ª–∏–¥–µ—Ä—Å—Ç–≤–æ") || lowerText.includes("–ø–æ–±–µ–¥") || lowerText.includes("–≥–æ—Ä–¥–∏—à—å—Å—è")) return <Crown {...props} color="#F59E0B" />;
  if (lowerText.includes("–ø—Ä–∞–∑–¥–Ω–∏–∫") || lowerText.includes("–≤–µ—á–µ—Ä–∏–Ω") || lowerText.includes("—Ä–∏—Ç—É–∞–ª") || lowerText.includes("—ë–ª–∫—É") || lowerText.includes("–Ω–æ–≤—ã–π –≥–æ–¥")) return <PartyPopper {...props} color="#c82926" />;
  if (lowerText.includes("–¥—Ä—É–≥") || lowerText.includes("–∫–æ–ª–ª–µ–≥") || lowerText.includes("–ª—é–¥") || lowerText.includes("–∑–Ω–∞–∫–æ–º—Å—Ç–≤")) return <Users {...props} color="#706c91" />;
  if (lowerText.includes("–º—É–∑—ã–∫") || lowerText.includes("–ø–µ—Å–Ω") || lowerText.includes("—Å–ª—É—à–∞–π")) return <Music {...props} color="#c82926" />;
  if (lowerText.includes("—Å–≤–µ—á") || lowerText.includes("–æ–≥–æ–Ω—å")) return <Sun {...props} color="#F59E0B" />;
  return <Gift {...props} color="#c82926" />;
};

export default function AdventCalendar() {
  const [user, setUser] = useState(null);
  const [openedDays, setOpenedDays] = useState({});
  const [modalData, setModalData] = useState(null);
  const [toastMessage, setToastMessage] = useState(null);
  
  const [currentDate, setCurrentDate] = useState(1); 
  const [isDevMode, setIsDevMode] = useState(true);

  // –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (–∞–Ω–æ–Ω–∏–º–Ω–æ)
  useEffect(() => {
    const initAuth = async () => {
      try {
        await signInAnonymously(auth);
      } catch (e) {
        console.error('Auth error:', e);
      }
    };
    initAuth();
    const unsubscribe = onAuthStateChanged(auth, setUser);
    return () => unsubscribe();
  }, []);

  // –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∏–∑ Firestore
  useEffect(() => {
    if (!user) return;
    const progressRef = collection(db, 'artifacts', appId, 'users', user.uid, 'advent_progress');
    const unsubscribe = onSnapshot(progressRef, (snapshot) => {
      const data = {};
      snapshot.docs.forEach(docSnap => {
        data[docSnap.id] = docSnap.data().message;
      });
      setOpenedDays(data);
    }, (error) => console.error("Error fetching progress:", error));
    return () => unsubscribe();
  }, [user]);

  // –ê–≤—Ç–æ-—Å–∫—Ä—ã—Ç–∏–µ —Ç–æ—Å—Ç–∞
  useEffect(() => {
    if (toastMessage) {
      const timer = setTimeout(() => {
        setToastMessage(null);
      }, 2000);
      return () => clearTimeout(timer);
    }
  }, [toastMessage]);

  const handleDayClick = async (dayNumber) => {
    if (!user) return;

    // –ë—É–¥—É—â–µ–µ ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ—Å—Ç –∏ –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ–º
    if (dayNumber > currentDate) {
      setToastMessage("–≠—Ç–æ—Ç –¥–µ–Ω—å –µ—â–µ –Ω–µ –Ω–∞—Å—Ç–∞–ª");
      return; 
    }

    if (openedDays[dayNumber]) {
      setModalData({ day: dayNumber, text: openedDays[dayNumber], isNew: false });
      return;
    }

    const receivedWishes = Object.values(openedDays);
    const availableWishes = WISHES_POOL.filter(w => !receivedWishes.includes(w));
    const pool = availableWishes.length > 0 ? availableWishes : WISHES_POOL;
    const randomWish = pool[Math.floor(Math.random() * pool.length)];

    try {
      const dayDocRef = doc(db, 'artifacts', appId, 'users', user.uid, 'advent_progress', String(dayNumber));
      await setDoc(dayDocRef, { day: dayNumber, message: randomWish, openedAt: serverTimestamp() });
      setModalData({ day: dayNumber, text: randomWish, isNew: true });
    } catch (e) {
      console.error("Error saving wish:", e);
    }
  };

  const closeModal = () => setModalData(null);

  // –°–µ—Ç–∫–∞ –¥–Ω–µ–π
  const daysGrid = [
    -1, 0, 
    ...Array.from({ length: 31 }, (_, i) => i + 1)
  ];

  const getDevDateLabel = (val) => val <= 0 ? `${30 + val} –Ω–æ—è–±—Ä—è` : `${val} –¥–µ–∫–∞–±—Ä—è`;
  const getDevStatusLabel = (val) => val <= -1 ? "üîì –î–æ—Å—Ç—É–ø–Ω–æ: 29.11" : (val <= 0 ? "üîì –î–æ—Å—Ç—É–ø–Ω–æ: 30.11" : `üîì –î–æ—Å—Ç—É–ø–Ω–æ –¥–æ: ${val} –¥–µ–∫`);
  
  const getCardLabel = (day) => {
    if (day === -1) return "29.11";
    if (day === 0) return "30.11";
    return day;
  };

  const getModalTitle = (day) => {
    if (day === -1) return "29 –Ω–æ—è–±—Ä—è";
    if (day === 0) return "30 –Ω–æ—è–±—Ä—è";
    return `–î–µ–Ω—å ${day}`;
  };

  return (
    <div 
      className="min-h-screen w-full flex flex-col items-center font-sans relative overflow-x-hidden selection:bg-red-200"
      style={{ backgroundColor: COLORS.dawnPink, color: COLORS.tuatara }}
    >
      {/* –®–∞–ø–∫–∞ */}
      <header className="w-full max-w-md p-6 flex flex-col items-center text-center mt-4">
        <div className="mb-4">
          <div className="bg-white p-2 rounded-xl shadow-sm border border-stone-200">
            <span className="text-sm font-bold tracking-widest text-[#363636]">LIFEPRACTIC</span>
          </div>
        </div>
        
        <h1 className="text-2xl font-bold leading-tight mb-2">
          –ê–¥–≤–µ–Ω—Ç-–∫–∞–ª–µ–Ω–¥–∞—Ä—å<br/>–∫–æ–º–∞–Ω–¥—ã LifePractic
        </h1>
        <p className="text-sm opacity-60 font-medium">
          31 –¥–µ–Ω—å –º–∞–ª–µ–Ω—å–∫–∏—Ö —Ä–∞–¥–æ—Å—Ç–µ–π –∏ –ø–æ–∂–µ–ª–∞–Ω–∏–π
        </p>
      </header>

      {/* –°–µ—Ç–∫–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä—è */}
      <main className="w-full max-w-md p-4 pb-32">
        <div className="grid grid-cols-5 gap-3 sm:gap-4">
          {daysGrid.map((day) => {
            const isFuture = day > currentDate;
            const isOpened = !!openedDays[day];
            const isAvailable = !isFuture && !isOpened;
            
            const isFancyTree = day > 15;
            const treeColor = isFancyTree ? COLORS.fireEngineRed : COLORS.forestGreen;

            return (
              <button
                key={day}
                onClick={() => handleDayClick(day)}
                className={`
                  aspect-[4/5] rounded-[18px] flex flex-col items-center justify-center relative transition-all duration-300
                  ${isFuture ? 'cursor-not-allowed active:scale-95' : 'cursor-pointer hover:-translate-y-1 active:scale-95'}
                `}
                style={{
                  backgroundColor: isOpened ? COLORS.bone : (isFuture ? COLORS.dawnPink : COLORS.white),
                  border: isAvailable ? `2px solid ${COLORS.fireEngineRed}` : (isFuture ? `1px solid rgba(199, 184, 149, 0.3)` : 'none'),
                  boxShadow: isAvailable ? '0 4px 12px rgba(200, 41, 38, 0.15)' : 'none',
                  opacity: isFuture ? 0.8 : 1
                }}
              >
                <span 
                  className={`font-semibold z-10 ${isFuture ? 'opacity-40' : ''} ${day <= 0 ? 'text-xs' : 'text-lg'}`}
                  style={{ color: isFuture ? COLORS.rodeoDust : COLORS.tuatara }}
                >
                  {getCardLabel(day)}
                </span>

                <div className="mt-1">
                  {isFuture && (
                    <Lock size={14} color={COLORS.rodeoDust} className="opacity-60" />
                  )}
                  {isOpened && (
                    <div className="flex items-center justify-center animate-pulse relative">
                      <TreePine size={16} color={treeColor} />
                      {isFancyTree && (
                        <Sparkles size={10} color={COLORS.rodeoDust} className="absolute -top-1 -right-1" />
                      )}
                    </div>
                  )}
                </div>
              </button>
            );
          })}
        </div>
      </main>

      {/* –¢–æ—Å—Ç */}
      {toastMessage && (
        <div className="fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-[60]">
          <div className="bg-[#363636] text-white px-6 py-3 rounded-full shadow-xl flex items-center gap-2 text-sm font-medium whitespace-nowrap">
            <Lock size={16} className="text-[#e3dbca]" />
            {toastMessage}
          </div>
        </div>
      )}

      {/* –ú–æ–¥–∞–ª–∫–∞ */}
      {modalData && (
        <div className="fixed inset-0 z-50 flex items-center justify-center p-4">
          <div 
            className="absolute inset-0 bg-black/40 backdrop-blur-sm transition-opacity"
            onClick={closeModal}
          ></div>
          
          <div 
            className="bg-white w-full max-w-sm rounded-[24px] p-8 relative shadow-2xl transform transition-all scale-100 flex flex-col items-center text-center"
          >
            <div className="mb-6 bg-[#f1eae0] p-6 rounded-full inline-flex items-center justify-center shadow-inner">
              {getThematicIllustration(modalData.text)}
            </div>

            <h3 className="text-xl font-bold mb-2 text-[#363636]">
              {getModalTitle(modalData.day)}
            </h3>
            
            <div className="w-12 h-1 bg-[#c82926] rounded-full mb-6 opacity-20 mx-auto"></div>

            <p className="text-lg leading-relaxed mb-8 text-[#363636]">
              ¬´{modalData.text}¬ª
            </p>

            <button
              onClick={closeModal}
              className="w-full py-3.5 rounded-xl font-semibold text-white transition-transform active:scale-95 shadow-lg shadow-red-200"
              style={{ backgroundColor: COLORS.fireEngineRed }}
            >
              –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –∫–∞–ª–µ–Ω–¥–∞—Ä—é
            </button>
          </div>
        </div>
      )}

      {/* Dev Tools */}
      <div className="fixed bottom-4 right-4 z-40 flex flex-col items-end gap-2 pointer-events-none">
        {isDevMode && (
          <div className="pointer-events-auto bg-white/95 backdrop-blur-md border border-gray-200 p-4 rounded-2xl shadow-2xl w-64 mb-2">
            <div className="flex justify-between items-center mb-3">
              <h4 className="font-bold text-xs uppercase tracking-wider text-gray-500">–°–∏–º—É–ª—è—Ü–∏—è –í—Ä–µ–º–µ–Ω–∏</h4>
              <button onClick={() => setIsDevMode(false)} className="text-gray-400 hover:text-gray-700">
                <X size={16} />
              </button>
            </div>

            <div className="flex flex-col gap-3">
              <label className="flex flex-col gap-1 text-xs">
                <div className="flex justify-between items-baseline">
                  <span className="text-sm font-bold text-[#c82926]">
                    {getDevDateLabel(currentDate)}
                  </span>
                  <span className="text-[10px] text-gray-500">
                    {currentDate <= 0 ? '–¢–µ—Å—Ç–æ–≤—ã–µ –¥–Ω–∏' : `–î–µ–Ω—å ${currentDate}`}
                  </span>
                </div>
                
                <input 
                  type="range" 
                  min="-1" 
                  max="31" 
                  step="1"
                  value={currentDate} 
                  onChange={(e) => setCurrentDate(Number(e.target.value))}
                  className="w-full cursor-pointer"
                />
                
                <div className="text-[10px] font-medium text-gray-600 bg-gray-50 p-1.5 rounded mt-1 border border-gray-100 text-center">
                  {getDevStatusLabel(currentDate)}
                </div>
              </label>
              
              <div className="h-px bg-gray-100 my-1"></div>

              <div className="text-gray-400 text-[10px] break-all">
                UID: {user ? user.uid.slice(0, 8) + '...' : 'Loading...'}
              </div>

              <button 
                className="bg-gray-100 hover:bg-gray-200 text-gray-600 px-3 py-2 rounded-lg text-xs font-medium transition-colors"
                onClick={() => setOpenedDays({})}
              >
                –°–±—Ä–æ—Å–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å –æ—Ç–∫—Ä—ã—Ç–∏—è
              </button>
            </div>
          </div>
        )}
